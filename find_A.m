function [X_1, A_1, X_2, A_2] = find_A(h, l, i1, i2,i3,w2, k2, w, k, m, n, options, h_A)

    %начало вычислений 
    t = l
    o = h-l
    
    if i1==1
        th0_1=0
    else
        th0_1=pi/2
    end

    if i2==1
        th0_2= pi+m*pi
        th0_3=0
    else
        th0_2= pi/2+m*pi
        th0_3= pi/2
    end

    if i3==1
        th0_4=pi+(n-m)*pi
    else
        th0_4=pi/2+(n-m)*pi
    end

    c1=1/2
    c2=(1+k.^(-2))/2
    
    %================_____th_H_____=====================
    th_H_1_L=ode45(@(x, H) ODE_th_H_1_L( x, H, w, k, o, t), [0, 1/2], [th0_1, 0, 0], options)
    th_H_1_R=ode45(@(x, H) ODE_th_H_1_R( x, H, w, k, o, t), [1, 1/2], [th0_2, 0, 0], options)
    th_H_2_L=ode45(@(x, H) ODE_th_H_2_L( x, H, w, k, o, t), [1, (1+k.^(-2))/2], [th0_3 ,0, 0], options)
    th_H_2_R=ode45(@(x, H) ODE_th_H_2_R( x, H, w, k, o, t), [k.^(-2), (1+k.^(-2))/2], [th0_4, 0, 0], options)

     %================_____fi_0______=====================
    th = deval(th_H_1_L, c1)
    fi0_1=th(1)+pi/2
    th = deval(th_H_1_R, c1)
    fi0_2=th(1)+pi/2
    th = deval(th_H_2_L, c2)
    fi0_3=th(1)+pi/2
    th = deval(th_H_2_R, c2)
    fi0_4=th(1)+pi/2

     %================_____y_0____=====================
    H_0_1_L = deval(th_H_1_L, c1)
    H_0_1_R = deval(th_H_1_R, c1)
    H_0_2_L = deval(th_H_2_L, c2)
    H_0_2_R = deval(th_H_2_R, c2)

    y_0_1=(H_0_1_L(2)-H_0_1_R(2))^(-1/2)
    y_0_2=(H_0_2_L(2)-H_0_2_R(2))^(-1/2)

     %================_____fi_y_____=====================
    fi_y_1_L=ode45(@(x, fi) ODE_fi_y_1_L( x, fi, w, k, o, t), [1/2, 0], [fi0_1, y_0_1], options)
    fi_y_1_R=ode45(@(x, fi) ODE_fi_y_1_R( x, fi, w, k, o, t), [1/2, 1], [fi0_1, y_0_1], options)
    fi_y_2_L=ode45(@(x, fi) ODE_fi_y_2_L( x, fi, w, k, o, t), [(1+k.^(-2))/2, 1], [fi0_2, y_0_2], options)
    fi_y_2_R=ode45(@(x, fi) ODE_fi_y_2_R( x, fi, w, k, o, t), [(1+k.^(-2))/2, k.^(-2)], [fi0_2, y_0_2], options)

   %================_____a1, a2_____=====================
    H_1_1_L = deval(th_H_1_L,c1)
    H_1_1_R = deval(th_H_1_R,c1)
    H_1_2_L = deval(th_H_2_L,c2)
    H_1_2_R = deval(th_H_2_R,c2)

    I2 = (H_1_1_L(3) - H_1_1_R(3)) / (H_0_1_L(2) - H_0_1_R(2))
    J2 = (H_1_2_L(3) - H_1_2_R(3)) / (H_0_2_L(2) - H_0_2_R(2))

    C = (J2-I2)^(-1/4)
    
    if i2==0
    a1 = ((abs(A_2_L( 1 , w, k, o, t,  th_H_2_L, fi_y_2_L)/ A_1_R( 1 , w, k, o, t,  th_H_1_R, fi_y_1_R)))^(1/2))*C
    a2 = (a1^(-1))*(C^2)
    if A_2_L( 1 , w, k, o, t,  th_H_2_L,  fi_y_2_L)* A_1_R( 1 , w, k, o, t,  th_H_1_R, fi_y_1_R) < 0
        a2 = -a2
    end
    else
        a1 = ((abs(diff_A_2_L( 1 , w, k, o, t, th_H_2_L, fi_y_2_L) * ((diff_A_1_R( 1, w, k, o, t,  th_H_1_R, fi_y_1_R))^(-1))))^(1/2))*C 
        a2 = (a1^(-1))*(C^2)
        if A_2_L( 1 , w, k, o, t, th_H_2_L, fi_y_2_L)* A_1_R( 1 , w, k, o, t,  th_H_1_R, fi_y_1_R)< 0
            a2 = -a2
        end
    end

    %================_____A_____=====================
    X_1=[]
    A_1=[]

    for i =  0: h_A : 1/2 - h_A
        X_1(end+1) = i
        A_1(end+1) =  a1 * A_1_L( i , w, k, o, t,  th_H_1_L, fi_y_1_L)
    end

    for i = 1/2: h_A :1 - h_A
       X_1(end+1) = i
       A_1(end+1) = a1 * A_1_R( i , w, k, o, t,  th_H_1_R,  fi_y_1_R)
    end
 
    X_1(end+1) = 1
    A_1(end+1) = a1 * A_1_R( 1 , w, k, o, t,  th_H_1_R,  fi_y_1_R)
        
    X_2=[]
    A_2=[]
    for i =  1: h_A : (1+k.^(-2))/2 - h_A
        X_2(end+1) = i
        A_2(end+1) =  a2 * A_2_L( i , w, k, o, t,  th_H_2_L, fi_y_2_L)
    end

    for i = (1+k.^(-2))/2: h_A : k^(-2) - h_A
       X_2(end+1) = i
       A_2(end+1) = a2 * A_2_R( i , w, k, o, t,  th_H_2_R,  fi_y_2_R)
    end
    
    X_2(end+1) = k^(-2)
    A_2(end+1) = a2 * A_2_R( k^(-2) , w, k, o, t,  th_H_2_R,  fi_y_2_R)
end

%Функции тета, H0, H1
function res = ODE_th_H_1_L( x, H, w, k, o, t)
    v2 =exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1
    v =(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*sign(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)*(16*w^2*x^3 - (4*t*x)/k^2))/(8*(abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2)) + (4*exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*sign(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)*(16*w^2*x^3 - (4*t*x)/k^2)*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1))/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)^2)/(2*(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    f=(2*(x^2)-1)*(2*(x^2)-(k^(-2)))/8
    q=o*(k^(-2))+(1-2*(x^2))*t*(k^(-2))+4*(w^2)*(x^4)
    ode_th=(v2/(f^(1/2)))*((cos(H(1)))^2)+(q/(4*v2*(f^(1/2))))*((sin(H(1)))^2)+(diff_v/v)*(sin(2*H(1)))
    ode_H_0 = 2*(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*H(1)))/2)*H(2)+((sin(H(1)))^2)/(v2*(f^(1/2)))
    ode_H_1 = 2*(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*H(1)))/2)*H(3)+x*((sin(H(1)))^2)/(v2*(f^(1/2)))
    res = [ode_th; ode_H_0; ode_H_1]
end

function res = ODE_th_H_1_R( x, H, w, k, o, t)
    v2 = exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1
    v = (exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*sign(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)*(2*w^2*(4*x - 4)*(2*(x - 1)^2 - 1) + (2*t*(2*x - 2))/k^2))/(8*(abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2)) + (4*exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*sign(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)*(2*w^2*(4*x - 4)*(2*(x - 1)^2 - 1) + (2*t*(2*x - 2))/k^2)*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1))/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)^2)/(2*(exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    f=(1-2*((1-x)^2))*((k^(-2))-1+2*((1-x)^2))/8
    q=o*(k^(-2))+2*t*(k^(-2))*((1-x)^2)+(w^2)*((1-2*((1-x)^2))^2)
    ode_th=(v2/(f^(1/2)))*((cos(H(1)))^2)+(q/(4*v2*(f^(1/2))))*((sin(H(1)))^2)+(diff_v/v)*(sin(2*H(1)))
    ode_H_0 = 2*(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*H(1)))/2)*H(2)+((sin(H(1)))^2)/(v2*(f^(1/2)))
    ode_H_1 = 2*(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*H(1)))/2)*H(3)+x*((sin(H(1)))^2)/(v2*(f^(1/2)))
    res = [ode_th; ode_H_0; ode_H_1]
end

function res = ODE_th_H_2_L( x, H, w, k, o, t)
    v2 = exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1 
    v =(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2)
    diff_v = -((exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*sign(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))*((2*t*(2*x - 2))/(k^2*(1/k^2 - 1)) - (4*w^2*(2*x - 2)*((2*(x - 1)^2)/(1/k^2 - 1) + 1))/(1/k^2 - 1)))/(8*(abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2)) + (4*exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*sign(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))*((2*t*(2*x - 2))/(k^2*(1/k^2 - 1)) - (4*w^2*(2*x - 2)*((2*(x - 1)^2)/(1/k^2 - 1) + 1))/(1/k^2 - 1))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1))/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))^2)/(2*(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2))
    f=((k^(-2))-1+2*((x-1)^2))*(1-(k^(-2))+2*((x-1)^2)*((k^(-2))-1)^(-1))/8
    q=o*(k^(-2))-2*((x-1)^2)*(((k^(-2))-1)^(-1))*t*(k^(-2))+(w^2)*((1+2*((x-1)^2)/((k^(-2))-1))^2)
    ode_th=(v2/((-f)^(1/2)))*((cos(H(1)))^2)-(q/(4*v2*((-f)^(1/2))))*((sin(H(1)))^2)+(diff_v/v)*(sin(2*H(1)))
    ode_H_0=2*(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*H(1)))/2)*H(2)+((sin(H(1)))^2)/(v2*((-f)^(1/2)))
    ode_H_1=2*(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*H(1)))/2)*H(3)+x*((sin(H(1)))^2)/(v2*((-f)^(1/2)))
    res = [ode_th; ode_H_0; ode_H_1]
end

function res = ODE_th_H_2_R( x, H, w, k, o, t)
    f=((k^(-2))*((k^(-2))-1)-2*((x-(k^(-2)))^2))*((-(k^(-2))+1+2*((x-(k^(-2)))^2)*((k^(-2))-1)^(-1)))/8
    q=o*(k^(-2))-t*(k^(-2))*((k^(-2))-1-2*((x-(k^(-2)))^2)*(((k^(-2))-1)^(-1)))+(w^2)*(((k^(-2))-2*(((x-(k^(-2)))^2))/((k^(-2))-1))^2)
    v2 =exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1
    v =(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((sign(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)*exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((2*t*(2*x - 2/k^2))/(k^2*(1/k^2 - 1)) + (4*w^2*(2*x - 2/k^2)*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2))/(1/k^2 - 1)))/(8*(abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2)) + (4*sign(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)*exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1)*((2*t*(2*x - 2/k^2))/(k^2*(1/k^2 - 1)) + (4*w^2*(2*x - 2/k^2)*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2))/(1/k^2 - 1)))/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)^2)/(2*(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    ode_th=(v2/((-f)^(1/2)))*((cos(H(1)))^2)-(q/(4*v2*((-f)^(1/2))))*((sin(H(1)))^2)+(diff_v/v)*(sin(2*H(1)))
    ode_H_0 =2*(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*H(1)))/2)*H(2)+((sin(H(1)))^2)/(v2*((-f)^(1/2)))
    ode_H_1=2*(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*H(1)))/2)*H(3)+x*((sin(H(1)))^2)/(v2*((-f)^(1/2)))
    res = [ode_th; ode_H_0; ode_H_1]
end

% Функции фи и гамма
function res = ODE_fi_y_1_L( x, y, w, k, o, t)
    v2 =exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1
    v =(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*sign(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)*(16*w^2*x^3 - (4*t*x)/k^2))/(8*(abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2)) + (4*exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*sign(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)*(16*w^2*x^3 - (4*t*x)/k^2)*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1))/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)^2)/(2*(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    f=(2*(x^2)-1)*(2*(x^2)-(k^(-2)))/8
    q=o*(k^(-2))+(1-2*(x^2))*t*(k^(-2))+4*(w^2)*(x^4)
    ode_fi=(v2/(f^(1/2)))*((cos(y(1)))^2)+(q/(4*v2*(f^(1/2))))*((sin(y(1)))^2)+(diff_v/v)*(sin(2*y(1)))
    ode_y=(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*y(1)))/2+(diff_v/v)*(cos(2*y(1))))*y(2)
    res = [ode_fi; ode_y]
end

function res = ODE_fi_y_1_R( x, y, w, k, o, t)
    v2 =exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1
    v =(exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*sign(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)*(2*w^2*(4*x - 4)*(2*(x - 1)^2 - 1) + (2*t*(2*x - 2))/k^2))/(8*(abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2)) + (4*exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*sign(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)*(2*w^2*(4*x - 4)*(2*(x - 1)^2 - 1) + (2*t*(2*x - 2))/k^2)*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1))/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)^2)/(2*(exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    f=(1-2*((1-x)^2))*((k^(-2))-1+2*((1-x)^2))/8
    q=o*(k^(-2))+2*t*(k^(-2))*((1-x)^2)+(w^2)*((1-2*((1-x)^2))^2)
    ode_fi=(v2/(f^(1/2)))*((cos(y(1)))^2)+(q/(4*v2*(f^(1/2))))*((sin(y(1)))^2)+(diff_v/v)*(sin(2*y(1)))
    ode_y=(((q/(4*v2*(f^(1/2))))-(v2/(f^(1/2))))*(sin(2*y(1)))/2+(diff_v/v)*(cos(2*y(1))))*y(2)
    res = [ode_fi; ode_y]
end

function res = ODE_fi_y_2_L( x, y, w, k, o, t)
    v2 = exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1 
    v =(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2)
    diff_v = -((exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*sign(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))*((2*t*(2*x - 2))/(k^2*(1/k^2 - 1)) - (4*w^2*(2*x - 2)*((2*(x - 1)^2)/(1/k^2 - 1) + 1))/(1/k^2 - 1)))/(8*(abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2)) + (4*exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*sign(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))*((2*t*(2*x - 2))/(k^2*(1/k^2 - 1)) - (4*w^2*(2*x - 2)*((2*(x - 1)^2)/(1/k^2 - 1) + 1))/(1/k^2 - 1))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1))/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))^2)/(2*(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2))
    f=((k^(-2))-1+2*((x-1)^2))*(1-(k^(-2))+2*((x-1)^2)*((k^(-2))-1)^(-1))/8
    q=o*(k^(-2))-2*((x-1)^2)*(((k^(-2))-1)^(-1))*t*(k^(-2))+(w^2)*((1+2*((x-1)^2)/((k^(-2))-1))^2)
    ode_fi=(v2/((-f)^(1/2)))*((cos(y(1)))^2)-(q/(4*v2*((-f)^(1/2))))*((sin(y(1)))^2)+(diff_v/v)*(sin(2*y(1)))
    ode_y=(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*y(1)))/2+(diff_v/v)*(cos(2*y(1))))*y(2)
    res = [ode_fi; ode_y]
end

function res = ODE_fi_y_2_R( x, y, w, k, o, t)
    f=((k^(-2))*((k^(-2))-1)-2*((x-(k^(-2)))^2))*((-(k^(-2))+1+2*((x-(k^(-2)))^2)*((k^(-2))-1)^(-1)))/8
    q=o*(k^(-2))-t*(k^(-2))*((k^(-2))-1-2*((x-(k^(-2)))^2)*(((k^(-2))-1)^(-1)))+(w^2)*(((k^(-2))-2*(((x-(k^(-2)))^2))/((k^(-2))-1))^2)
    v2 =exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1
    v =(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    diff_v =((sign(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)*exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((2*t*(2*x - 2/k^2))/(k^2*(1/k^2 - 1)) + (4*w^2*(2*x - 2/k^2)*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2))/(1/k^2 - 1)))/(8*(abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2)) + (4*sign(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)*exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1)*((2*t*(2*x - 2/k^2))/(k^2*(1/k^2 - 1)) + (4*w^2*(2*x - 2/k^2)*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2))/(1/k^2 - 1)))/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)^2)/(2*(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2))
    ode_fi=(v2/((-f)^(1/2)))*((cos(y(1)))^2)-(q/(4*v2*((-f)^(1/2))))*((sin(y(1)))^2)+(diff_v/v)*(sin(2*y(1)))
    ode_y=(((-q/(4*v2*((-f)^(1/2))))-(v2/((-f)^(1/2))))*(sin(2*y(1)))/2+(diff_v/v)*(cos(2*y(1))))*y(2)
    res = [ode_fi; ode_y]
end

%производная Собственной функции - делта большое
function diff_A = diff_A_1_L( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    diff_A = -v*y(2)*cos(th(1))*(sin(th(1)-fi(1))^(-1))
end

function diff_A = diff_A_1_R( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    diff_A = -v*y(2)*cos(th(1))*(sin(th(1)-fi(1))^(-1))
end

function diff_A = diff_A_2_L( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    diff_A = -v*y(2)*cos(th(1))*(sin(th(1)-fi(1))^(-1))
end

function diff_A = diff_A_2_R( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    diff_A = -v*y(2)*cos(th(1))*(sin(th(1)-fi(1))^(-1))
end

%Собственная функция - делта большое
function A = A_1_L( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2))*((abs(4*w^2*x^4 + o/k^2 - (t*(2*x^2 - 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    A = - y(2)*sin(th(1))/(v*sin(th(1)-fi(1)))
end

function A = A_1_R( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2))*((abs(w^2*(2*(x - 1)^2 - 1)^2 + o/k^2 + (2*t*(x - 1)^2)/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    A = - y(2)*sin(th(1))/(v*sin(th(1)-fi(1)))
end

function A = A_2_L( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1))))*((abs(w^2*((2*(x - 1)^2)/(1/k^2 - 1) + 1)^2 + o/k^2 - (2*t*(x - 1)^2)/(k^2*(1/k^2 - 1)))/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    A = - y(2)*sin(th(1))/(v*sin(th(1)-fi(1)))
end

function A = A_2_R( x,  w, k, o, t, th_H, fi_y)
    v =(exp(-4/abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2))*((abs(w^2*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2)^2 + o/k^2 + (t*((2*(x - 1/k^2)^2)/(1/k^2 - 1) - 1/k^2 + 1))/k^2)/4)^(1/2) - 1) + 1)^(1/2)
    th= deval(th_H, x)
    y= deval(fi_y, x)
    fi= deval(fi_y, x)
    A = - y(2)*sin(th(1))/(v*sin(th(1)-fi(1)))
end